
#include <iostream>
#include<math.h>
using namespace std;
float Mean(int*,int );
float median(int*,int );
int mode(int *)
float stndev(int *,int );
float Mean(int *array,int n)
{
    int j;
    float s=0;
    for(j=0;j<n;j++)
    {
        s=s+array[j];
    }
    return(s/n);
}
float median(int *array,int n)
{ int i,j,t;
    for(i=0;i<n;i++)
    {
        for(j=0;j<n-1;j++)
        {
            if(array[j]>array[j+1])
            {
                t=array[j];
                array[j]=array[j+1];
                array[j+1]=t;
            }
        }
    }
    if(n%2!=0)
    {
        return(array[(n+1)/2-1]);
    }
    else
    {
        return((array[n/2-1]+array[n/2])/2.0);
    }
}
float stndev(int *array,int n)
{
    int i;
    float m=Mean(array,n);
    float f;
     f=0;
    for(i=0;i<n;i++)
    {
        f=f+(m-array[i])*(m-array[i]);
    }
    float x;
x=f/n;
    return(sqrt(x));
}
int mode(int *a,int n) {
   int maxValue = 0, maxCount = 0, i, j;

   for (i = 0; i < n; ++i) {
      int count = 0;
      
      for (j = 0; j < n; ++j) {
         if (a[j] == a[i])
         ++count;
      }
      
      if (count > maxCount) {
         maxCount = count;
         maxValue = a[i];
      }
   }

   return maxValue;
}

struct appstack
{   int size;
    int top1=-1,top2;
    int *array;
    void push1(int a)
    {
     top1++; 
     array[top1]=a;
           
     }
    void push2(int a)
    {
     top2--; 
     array[top2]=a;
        
    }
     
    void pop1()
    {array[top1]=0;
     top1--;
     }
    void pop2()
    {
     array[top2]=0;
     top2++;}
    
};

int main()
{struct appstack howard;
  int n,m,i=0,j,mean;
   scanf("%d%d",&n,&m);
  howard.size=n;
  howard.top2=n;
  int sheldon[m],k=0;
  while(i==m)
  {sheldon[i]=0;}
  howard.array=(int*)malloc(n*sizeof(int));
  for(i=0;i<n;i++)
{
howard.array[i]=0;
}
 int arr[m][3];
   for(i=0;i<m;i++)
   {for(j=0;j<3;j++)
    {scanf("%d",&arr[i][j]);}
    if(arr[i][0]==1)
    {  sheldon[k]=arr[i][2];
    k++;
        if(arr[i][1]==1)
     howard.push1(arr[i][2]);
     else if(arr[i][1]==2)
      howard.push2(arr[i][2]);
    }
    else if(arr[i][0]==2)
  { if(arr[i][1]==1)
  howard.pop1();
else if(arr[i][1]==2)
howard.pop2();
}
}
printf("\n%f ",Mean(sheldon,k)) ;
printf("%f ",median(sheldon,k)) ;
printf("%d ",mode(sheldon,k)) ;
printf("%f \n",stndev(sheldon,k)) ;
while(howard.top1!=-1)
{cout<<howard.array[howard.top1]<<" ";
howard.top1--;}
while(howard.top2!=n)
{cout<<endl<<howard.array[howard.top2]<<" ";
howard.top2++;}
  return 0;
}
